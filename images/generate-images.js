const fs=require("fs"),path=require("path"),puppeteer=require("puppeteer"),specialImages=["express.jpg","teacher.jpg","roses.jpg"],bouquetImages=["cloud.jpg","sunrise.jpg","sunny.jpg","lavender.jpg","breeze.jpg","pink.jpg","royal.jpg","tenderness.jpg","luxury.jpg","garden.jpg","purple-mist.jpg","lagoon.jpg","premium.jpg","dream.jpg","snow.jpg","sunny-lux.jpg","purple-paradise.jpg","blue-dream.jpg","fresh.jpg","purple.jpg","elegance.jpg","sunset.jpg","silk.jpg","violet.jpg","passion.jpg","diamond.jpg","pink-sapphire.jpg","purple-luxury.jpg","white-diamond.jpg","red-velvet.jpg"],masterclassImage="masterclass.jpg";function ensureDirectoryExists(e){fs.existsSync(e)||fs.mkdirSync(e,{recursive:!0})}async function generateImages(){const e=await puppeteer.launch(),n=await e.newPage();ensureDirectoryExists(path.join(__dirname,"special")),ensureDirectoryExists(path.join(__dirname,"bouquets")),console.log("Генерация изображений специальных предложений..."),await n.goto(`file://${path.join(__dirname,"special","placeholder.html")}`);for(const e of specialImages){const t=e.replace(".jpg",""),s=await n.$(`#${t}`);s?(await s.screenshot({path:path.join(__dirname,"special",e),type:"jpeg",quality:90}),console.log(`Создано изображение: special/${e}`)):console.error(`Элемент с ID ${t} не найден`)}console.log("Генерация изображений букетов..."),await n.goto(`file://${path.join(__dirname,"bouquets","placeholder.html")}`);const t=await n.evaluate((()=>{const e=document.querySelectorAll("[id]");return Array.from(e).map((e=>e.id))})),s={};t.forEach((e=>{bouquetImages.includes(`${e}.jpg`)&&(s[`${e}.jpg`]=e)}));let a=0;for(const e of bouquetImages)s[e]||(s[e]=t[a%t.length],a++);for(const e of bouquetImages){const t=s[e],a=await n.$(`#${t}`);a?(await a.screenshot({path:path.join(__dirname,"bouquets",e),type:"jpeg",quality:90}),console.log(`Создано изображение: bouquets/${e}`)):console.error(`Элемент с ID ${t} не найден`)}console.log("Генерация изображения для мастер-класса...");const o=path.join(__dirname,"temp-masterclass.html");fs.writeFileSync(o,'\n  <!DOCTYPE html>\n  <html>\n  <head>\n    <style>\n      body {\n        margin: 0;\n        padding: 0;\n        background: #f5f5f5;\n      }\n      .masterclass {\n        width: 800px;\n        height: 400px;\n        background: linear-gradient(45deg, #6a11cb, #2575fc);\n        position: relative;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n        font-family: Arial, sans-serif;\n      }\n      .masterclass-content {\n        text-align: center;\n        padding: 40px;\n        z-index: 2;\n      }\n      .masterclass-title {\n        font-size: 48px;\n        font-weight: bold;\n        margin-bottom: 20px;\n        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);\n      }\n      .masterclass-description {\n        font-size: 24px;\n        margin-bottom: 30px;\n        max-width: 600px;\n        line-height: 1.4;\n      }\n      .masterclass-button {\n        display: inline-block;\n        padding: 15px 30px;\n        background-color: white;\n        color: #6a11cb;\n        border-radius: 30px;\n        text-decoration: none;\n        font-weight: bold;\n        font-size: 18px;\n        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n      }\n      .flower {\n        position: absolute;\n        border-radius: 50%;\n        background-color: rgba(255, 255, 255, 0.2);\n      }\n    </style>\n  </head>\n  <body>\n    <div id="masterclass" class="masterclass">\n      <div class="flower" style="width: 100px; height: 100px; top: 50px; left: 50px;"></div>\n      <div class="flower" style="width: 150px; height: 150px; bottom: 70px; right: 60px;"></div>\n      <div class="flower" style="width: 80px; height: 80px; top: 200px; right: 180px;"></div>\n      <div class="flower" style="width: 120px; height: 120px; bottom: 150px; left: 180px;"></div>\n      <div class="masterclass-content">\n        <div class="masterclass-title">Мастер-класс по флористике</div>\n        <div class="masterclass-description">Научитесь создавать уникальные букеты под руководством опытных флористов</div>\n        <a href="#" class="masterclass-button">Записаться</a>\n      </div>\n    </div>\n  </body>\n  </html>\n  '),await n.goto(`file://${o}`);const i=await n.$("#masterclass");i&&(await i.screenshot({path:path.join(__dirname,masterclassImage),type:"jpeg",quality:90}),console.log(`Создано изображение: ${masterclassImage}`)),fs.unlinkSync(o),await e.close(),console.log("Все изображения успешно сгенерированы!")}generateImages().catch((e=>{console.error("Ошибка при генерации изображений:",e)}));